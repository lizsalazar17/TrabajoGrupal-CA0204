---
format: 
  pdf: 
    papersize: letter
    documentclass: article
    lang: es-CR
    titlepage: true
    fontsize: "11pt"
    mainfont: Times New Roman
    urlcolor: "blue"
    number-sections: true
    margin-left: "2.54cm"
    margin-right: "2.54cm"
    margin-top: "2.54cm"
    margin-bottom: "2.54cm"
    #include-before-body: Portada.qmd
    header-includes:
      - \usepackage{indentfirst}
      - \setlength{\parindent}{1.27cm}
editor: 
  markdown: 
    wrap: 72
---

\newpage

# Librerías 

```{r, echo=FALSE, warning=FALSE}
library(readr)

library(dplyr)

library(ggplot2)


```

# Bases de datos 

```{r}
url <- "https://raw.githubusercontent.com/eetefy2311/TP53-data/refs/heads/main/GermlineDownload_r21.csv"

temp.file <- tempfile(fileext = ".csv")

download.file(url, destfile = temp.file, mode = "wb")

base.de.datos <- read_csv(temp.file)
   
View(base.de.datos)
```

# Fundamentación del proyecto

## Pregunta de investigación

¿Cómo varía la expresión y la frecuencia de las mutaciones del gen TP53
en el tejido mamario de pacientes y personas en riesgo de desarrollar
cáncer de pecho, considerando los distintos grupos etarios? ¿Cómo se
relacionan los resultados obtenidos a los registrados en Costa Rica?

# Objetivos

## Objetivo general

Analizar la expresión y frecuencia de las mutaciones del gen TP53 en el
tejido mamario de pacientes y personas en riesgo de desarrollar cáncer
de pecho, diferenciando los resultados por grupos etarios.

## Objetivos específicos

-   Identificar las mutaciones más frecuentes del gen TP53 presentes en
    el tejido mamario de los individuos analizados.

-   Describir la distribución etaria de los casos diagnosticados con
    mutaciones en el gen TP53.

-   Determinar la relación existente entre los tipos de mutación y la
    edad al diagnóstico.

-   Comparar la prevalencia de casos según las regiones geográficas y
    consorcios internacionales de origen.

-   Formular hipótesis preliminares sobre la posible correlación entre
    las alteraciones del gen TP53 y la incidencia de cáncer de pecho en
    Costa Rica, a partir de los registros del Ministerio de Salud.

# Hipótesis

## Hipótesis general:

La expresión del gen TP53 en el tejido mamario presenta variaciones
significativas según el grupo etario, siendo más frecuentes las
mutaciones en adultos jóvenes y adultos medios.

# Hipótesis específicas:

-   H1: Las mutaciones más frecuentes del gen TP53 se concentran en
    individuos diagnosticados entre los 30 y 50 años.

-   H2: Existe una relación significativa entre el tipo de mutación
    (MUT_ID) y la edad al diagnóstico (Age_at_diagnosis).

-   H3: Las regiones con mayor representación de casos presentan también
    mayor diversidad mutacional del gen TP53.

(Agregar fuentes)

# Justificación

El estudio del gen TP53 es de vital importancia para la comprensión de
los mecanismos moleculares del cáncer de mama. Las mutaciones en este
gen pueden conducir a una proliferación celular descontrolada y a la
pérdida de la función supresora tumoral, incrementando el riesgo de
malignidad. Analizar su expresión por grupos etarios permitirá
identificar patrones que podrían asociarse a factores de riesgo
biológicos o ambientales específicos.

Además, la comparación con datos del Ministerio de Salud de Costa Rica
ofrece la posibilidad de contextualizar los hallazgos en la realidad
nacional, contribuyendo al diseño de estrategias de prevención y
detección temprana más precisas.

# Marco metodológico

El presente estudio se desarrollará bajo un enfoque cuantitativo de tipo
descriptivo. Su propósito será analizar cómo varía la expresión y la
frecuencia de las mutaciones del gen TP53 en el tejido mamario de
pacientes y personas en riesgo de desarrollar cáncer de pecho, tomando
en cuenta los diferentes grupos etarios. Este diseño permitirá observar
las relaciones existentes entre variables genéticas, demográficas y
clínicas sin manipularlas directamente, centrándose en la descripción,
comparación y correlación de los datos obtenidos.

La investigación se basará en el uso de bases de datos secundarias de
carácter público y científico. La principal fuente será la base
internacional The TP53 Dataset (versión R21), desarrollada por el
Instituto Nacional de Cáncer de los Estados Unidos, la cual contiene
información sobre más de 29,000 variantes tumorales y más de 2,000
individuos con mutaciones confirmadas en el gen TP53. De esta base se
seleccionarán los registros cuya topografía corresponda al tejido
mamario, a fin de centrar el análisis en los casos de cáncer de mama.
Complementariamente, se considerarán los registros nacionales
provenientes del Ministerio de Salud de Costa Rica (2022), con el
objetivo de contrastar los hallazgos internacionales con la incidencia
local del cáncer de mama.

En una primera etapa, se aplicarán estadísticas descriptivas con el fin
de caracterizar la población en estudio. Se calcularán medidas de
tendencia central (media, mediana y moda) y de dispersión (desviación
estándar y rango intercuartílico) para variables como la edad al
diagnóstico y la frecuencia de casos reportados. Asimismo, se elaborarán
tablas de frecuencia, histogramas y diagramas de caja, que permitirán
visualizar la distribución de las edades, la variación de las mutaciones
y la presencia de posibles valores atípicos. Este análisis inicial
ayudará a comprender la composición general de la muestra y a detectar
patrones preliminares en la distribución de las mutaciones según la
edad.

Posteriormente, se llevará a cabo un análisis comparativo entre grupos,
con el propósito de determinar si existen diferencias significativas en
la edad al diagnóstico según el tipo de mutación del gen TP53. Para ello
se aplicará una prueba de análisis de varianza (ANOVA), en caso de que
los datos cumplan con los supuestos de normalidad y homogeneidad de
varianzas. Si dichos supuestos no se cumplen, se recurrirá a la prueba
no paramétrica de Kruskal–Wallis, la cual permitirá contrastar las
medianas de edad entre grupos sin asumir una distribución normal. Este
análisis facilitará identificar si ciertos tipos de mutación se asocian
a edades de diagnóstico más tempranas o tardías.

(Añadir referencias)

Además, se aplicarán análisis de correlación con el fin de evaluar la
relación existente entre la edad al diagnóstico (Age_at_diagnosis) y el
número de casos reportados por los principales consorcios
internacionales (TCGA, ICGC y GENIE). Dependiendo de la distribución de
los datos, se utilizarán los coeficientes de correlación de *Pearson*
(para datos normales) o *Spearman* (para datos no normales). Estos
análisis permitirán establecer si la edad al diagnóstico se relaciona de
manera significativa con la frecuencia o severidad de las mutaciones del
gen TP53, aportando evidencia empírica a la hipótesis de que la edad
influye en la expresión de dicho gen.

Asimismo, se llevará a cabo un análisis de frecuencias y proporciones
para determinar la incidencia relativa de las mutaciones por grupo
etario y por tipo de mutación. Esta técnica permitirá identificar cuáles
grupos de edad presentan mayor prevalencia de mutaciones en el gen TP53,
lo que resultará clave para establecer patrones de riesgo y posibles
implicaciones clínicas.

Antes de aplicar los procedimientos inferenciales, se realizará una
limpieza y depuración de los datos (Esta se trabajó previamente en la
Bitácora 2). Este proceso incluirá la identificación de valores
faltantes, que serán tratados mediante eliminación o imputación según su
relevancia; la detección de valores atípicos a través del rango
intercuartílico (IQR), para garantizar la coherencia interna del
conjunto de datos. Este paso será fundamental para asegurar la calidad y
fiabilidad de los análisis posteriores.

De este modo, cada método estadístico aportará evidencia específica para
responder la pregunta de investigación:

-   Los análisis descriptivos permitirán conocer cómo se distribuyen la
    edad y las mutaciones del gen TP53.

-   Las pruebas de comparación (ANOVA/Kruskal–Wallis) identificarán si
    existen diferencias significativas en la edad de diagnóstico según
    el tipo de mutación.

-   Los análisis de correlación mostrarán si existe una relación entre
    la edad y la frecuencia de mutaciones reportadas.

-   Finalmente, el análisis de frecuencias permitirá observar la
    incidencia relativa de las mutaciones en cada grupo etario.

Posteriormente, se llevará a cabo un análisis comparativo entre regiones
geográficas, tomando como base la variable Country de la base
internacional. Se describirá la distribución de mutaciones del gen TP53
en diferentes países y regiones, con especial énfasis en América Latina.
Esta información se contrastará cualitativamente con la base de datos
del Ministerio de Salud de Costa Rica, para explorar si los patrones
internacionales guardan relación con las tasas de incidencia y
mortalidad por cáncer de mama en la población costarricense. Aunque no
se establecerán correlaciones estadísticas directas entre ambas bases
debido a la diferencia en el tipo de información, este ejercicio
permitirá contextualizar los resultados globales en el ámbito nacional,
y formular hipótesis sobre la posible prevalencia de mutaciones
similares en el país.

# Datos descriptivos

Frecuencias de MUT_ID

```{r}
frecuencias.mutaciones <- base.de.datos %>%
  group_by(MUT_ID) %>% 
  summarise(
    frecuencia = n(),
    porcentaje = round((n()/nrow(base.de.datos))*100, 3)
  ) %>% 
  arrange(desc(frecuencia))
```

Las diez mutaciones con mayor frecuencia

```{r}
top.mutaciones <- frecuencias.mutaciones %>% 
  head(10)
```

## **Estadísticas Descriptivas de la Edad**

Edad promedio: `r round(mean(base.de.datos$Age, na.rm = TRUE),1)` Edad
mediana: `r round(median(base.de.datos$Age, na.rm = TRUE),1)` Edad
máxima: `r round(max(base.de.datos$Age, na.rm = TRUE),1)` Edad mínima:
`r round(min(base.de.datos$Age, na.rm = TRUE),1)`

Primer cuartil:
`r round(quantile(base.de.datos$Age, 0.25, na.rm = TRUE),1)` Segundo
cuartil: `r round(quantile(base.de.datos$Age, 0.50, na.rm = TRUE),1)`
Tercer cuartil:
`r round(quantile(base.de.datos$Age, 0.75, na.rm = TRUE),1)`

Desviación estándar: `r round(sd(base.de.datos$Age, na.rm = TRUE),1)`
Varianza: `r round(var(base.de.datos$Age, na.rm = TRUE),1)` IQR:
`r round(IQR(base.de.datos$Age, na.rm = TRUE),1)`

# Gráficos

Histograma sobre la distribución de edades

```{r}
base.de.datos %>% 
  filter(!is.na(Age)) %>% 
  ggplot(aes(x = Age)) +
  geom_histogram(color = "black", fill = "lightblue") +
  scale_x_continuous(breaks = seq(0,100,5)) +
  labs(title = "Distribución de edades",
       x = "Edad",
       y = "Cantidad") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```

Boxplot de Edades con respecto al Efecto de Mutación

```{r}
base.de.datos %>%
  filter(!is.na(Age), !is.na(Effect)) %>%
  ggplot(aes(x = Effect, y = Age)) +
  geom_boxplot(fill = "lightblue", alpha = 0.7) +
  labs(title = "Distribución de Edades por Tipo de Efecto",
       x = "Tipo de Efecto",
       y = "Edad") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```

Boxplot de Edades con respecto a la Clase de Mutación

```{r}
base.de.datos %>%
  filter(!is.na(Age), !is.na(Class)) %>%
  ggplot(aes(x = Class, y = Age)) +
  geom_boxplot(fill = "lightgreen", alpha = 0.7) +
  scale_y_continuous(breaks = seq(0,100,10)) +
  labs(title = "Distribución de Edades por Tipo de Efecto",
       x = "Tipo de Mutación",
       y = "Edad") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```

Boxplot de Edades y Sexo

```{r}
base.de.datos %>%
  filter(!is.na(Age), !is.na(Sex)) %>%
  mutate(Sexo = ifelse(Sex == "F", "Femenino", "Masculino")) %>%
  ggplot(aes(x = Sexo, y = Age)) +
  geom_boxplot(fill = "#4AA0BD", alpha = 0.7) +
  scale_y_continuous(breaks = seq(0,100,10)) +
  labs(title = "Distribución de Edades por Tipo de Efecto",
       x = "Tipo de Mutación",
       y = "Edad") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

```

Histogramas de correlación de edad y conteo
```{r}
cor.data.diagnostico %>% 
  ggplot(aes(x = Age_at_diagnosis)) +
  geom_histogram(color = "black", fill = "lightblue", bins = 30) +
  labs(title = "Histograma de edades al diagnóstico",
       x = "Edad",
       y = "Frecuencia") +
  theme_minimal()

cor.data %>% 
  ggplot(aes(x = Age)) +
  geom_histogram(color = "black", fill = "lightblue", bins = 30) +
  labs(title = "Histograma de edades (alto porcentaje de NA)",
       x = "Edad",
       y = "Frecuencia") +
  theme_minimal()
```

Scatterplots de correlación de edad y conteo

```{r}
cor.data %>%
  ggplot(aes(x = Age, y = TCGA_ICGC_GENIE_count)) +
  geom_point(alpha = 0.6, color = "steelblue") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(title = "Edad vs Conteo TCGA/ICGC/GENIE",
       x = "Edad",
       y = "Conteo") +
  theme_minimal()

cor.data.diagnostico %>%
  ggplot(aes(x = Age_at_diagnosis, y = TCGA_ICGC_GENIE_count)) +
  geom_point(alpha = 0.6, color = "steelblue") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(title = "Edad al diagnóstico vs Conteo TCGA/ICGC/GENIE",
       x = "Edad al diagnóstico",
       y = "Conteo") +
  theme_minimal()
```

#Discusión y análisis de resultados

Aunque la hipótesis H2 plantea una relación entre el tipo de mutación (MUT_ID) y la edad al diagnóstico, en esta sección se analiza una variable sustituta relacionada con la frecuencia mutacional (TCGA_ICGC_GENIE_count) para evaluar si existe una asociación entre la edad y la presencia o cantidad de mutaciones reportadas por los consorcios internacionales. Este análisis permite explorar parcialmente la hipótesis H2, identificando si la edad podría estar relacionada con la carga mutacional observada en los pacientes.

```{r}
#Datos a utilizar para el proceso de correlación

cor.data.diagnostico <- base.de.datos.filtrada %>%
  filter(!is.na(Age_at_diagnosis), !is.na(TCGA_ICGC_GENIE_count)) %>%
  select(Age_at_diagnosis, TCGA_ICGC_GENIE_count)

cor.data <- base.de.datos.filtrada %>%
  filter(!is.na(Age), !is.na(TCGA_ICGC_GENIE_count)) %>%
  select(Age, TCGA_ICGC_GENIE_count)
```


Respecto a los histogramas (Figuras 5 y 6) 

## *Histograma de edades al diagnóstico*

El primer histograma muestra que la distribución de la edad al diagnóstico es asimétrica hacia la derecha (sesgo positivo). La mayoría de los casos se concentran entre los 25 y 40 años, con un pico marcado alrededor de los 30 años, lo que indica que este grupo etario es el más común en los registros disponibles.

A partir de los 45–50 años la frecuencia comienza a disminuir de manera notable, y existe una cola extendida hacia edades más avanzadas (hasta alrededor de 75–80 años), pero con muy pocos casos. Esta forma confirma que la distribución no es normal y que la base contiene una gran proporción de diagnósticos en edades relativamente jóvenes.

## *Histograma de edades (dataset con alto porcentaje de NA)*

El segundo histograma, aunque basado en un subconjunto más pequeño debido a la presencia de muchos valores NA, presenta una forma muy similar: un claro sesgo hacia la derecha y mayor concentración de casos entre los 25 y 40 años, con un máximo alrededor de los 30 años.

La menor cantidad total de observaciones hace que las barras sean más variables y que la forma no se vea tan suave, pero la tendencia general se mantiene: hay pocos casos en edades muy jóvenes (<20) y muy pocos casos por encima de los 60 años.

Ambos histogramas reflejan una tendencia consistente:

- La mayoría de los diagnósticos se dan en personas entre 25 y 40 años.

- La distribución presenta una cola hacia la derecha, indicando sesgo positivo.

- No se observa una distribución normal.

- La presencia de NA afecta la claridad del segundo histograma, pero no modifica la tendencia central.

Estos patrones apoyan parcialmente la hipótesis de que las alteraciones del gen TP53 en tejido mamario tienden a concentrarse en grupos etarios relativamente jóvenes.

Ahora, se procede a una prueba de normalidad por medio del método Shapiro-Wilk.

```{r}
shapiro.test(cor.data$Age)
shapiro.test(cor.data.diagnostico$Age_at_diagnosis)
shapiro.test(cor.data$TCGA_ICGC_GENIE_count)
```

Se evaluó la normalidad de las variables Edad (Age), Edad al diagnóstico (Age_at_diagnosis) y el conteo de casos (TCGA_ICGC_GENIE_count) mediante la prueba de Shapiro–Wilk. En los tres casos se obtuvo un valor p extremadamente pequeño (p < 0.05), indicando que ninguna de las variables sigue una distribución normal (Age: W = 0.929, p = 1.33×10⁻⁹; Age_at_diagnosis: W = 0.916, p < 2.2×10⁻¹⁶; TCGA_ICGC_GENIE_count: W = 0.653, p < 2.2×10⁻¹⁶).

Dado que las variables no cumplen el supuesto de normalidad —y considerando que el conteo es una variable discreta— se utilizó el coeficiente de correlación Spearman (ρ) para analizar la relación entre la edad y el conteo de mutaciones reportadas por los consorcios TCGA, ICGC y GENIE.

```{r, warning=FALSE}
cor.test(cor.data$Age, cor.data$TCGA_ICGC_GENIE_count, 
         method = "spearman")

cor.test(cor.data.diagnostico$Age_at_diagnosis, cor.data.diagnostico$TCGA_ICGC_GENIE_count, 
         method = "spearman")
```

Debido a que ninguna de las variables analizadas siguió una distribución normal según la prueba de Shapiro–Wilk (p < 0.05 en todos los casos), se utilizó el coeficiente de correlación de Spearman (ρ) para evaluar la relación entre la edad y el número de mutaciones reportadas por los consorcios TCGA, ICGC y GENIE.

En primer lugar, la correlación entre la edad (Age) y el conteo combinado de mutaciones (TCGA_ICGC_GENIE_count) no fue significativa (ρ = 0.073, p = 0.246). El valor de ρ, cercano a cero, indica que no existe relación entre la edad del paciente y la cantidad de mutaciones reportadas por los consorcios. Por lo tanto, la edad no parece influir en la frecuencia de mutaciones observadas en este grupo de individuos.

Por otro lado, se evaluó la correlación entre la edad al diagnóstico (Age_at_diagnosis) y el mismo conteo. En este caso se obtuvo un coeficiente negativo muy pequeño (ρ = –0.077) con un valor p significativo (p = 0.011). Aunque la asociación es estadísticamente significativa, la magnitud del coeficiente es extremadamente baja, lo que indica que la relación, aunque detectable debido al tamaño de la muestra, carece de relevancia práctica. En términos reales, la edad al diagnóstico apenas se relaciona con el número de mutaciones reportadas.

En conjunto, ambos análisis sugieren que ni la edad ni la edad al diagnóstico se asocian de manera consistente o relevante con el conteo de mutaciones TP53 provenientes de los consorcios TCGA, ICGC y GENIE.

Gráficamente, se puede observar mediante Figura 7 y Figura 8.

## Interpretación de los gráficos de dispersión (Scatterplots)

Los gráficos de dispersión (Figura 7 y 8) muestran visualmente la relación entre la edad y el conteo de mutaciones reportadas por los consorcios TCGA, ICGC y GENIE. En el caso de la variable Age, los puntos se encuentran ampliamente dispersos y la línea de tendencia lineal es casi horizontal, lo que confirma la ausencia de una relación clara entre ambas variables.

Para la variable Age_at_diagnosis, aunque la línea de tendencia presenta una leve pendiente negativa, la dispersión sigue siendo elevada, indicando que la relación es muy débil. Esto coincide con el valor de ρ obtenido en la correlación, que muestra una asociación estadísticamente significativa pero prácticamente irrelevante.


# Conclusiones

## Primera hipótesis 

Nuestra primera hipósis hipótesis fue que las edades estaban
concentradas en un rango entre los 30 y 50 años, basados en los
resultados obtenidos en el gráfico boxplot, se puede llegar a la
conclusión de que el rango de edad concentrado entre los 55 y 20 años,
con mayores frecuencias entre los 30 y 40 años. Por otro lado se obtuvo
que la edad promedio fue
`r round(mean(base.de.datos$Age, na.rm = TRUE),1)`, mientras que la
mediana de `r round(median(base.de.datos$Age, na.rm = TRUE),1)`, lo que
indica que no hay un sesgo a edades muy jóvenes o muy avanzadas; también
se puede decir que en general las mutaciones del gen TP53 no se está en
gran medida en pacientes de más de 50 años, sino que se está
concentrando en edades de menos de 50.

Además, se obtuvo que la mutación más frecuente fue la del identificador
4585 con 314 observaciones, representando un 6.754% del total de
observaciones, casi el doble que la mutación en el segundo lugar, la
cual tiene el identificador 2143 con 180 observaciones, que representa
un 3.872%, y la tercer mutación con mayor frecuencia fue el 3236 con 160
observaciones, representando un 3.442% del total de mutaciones.

## Conclusión del análisis de correlación (Segunda hipótesis de manera parcial)

El análisis de correlación realizado revela que la edad de los individuos no se asocia de manera relevante con el número de mutaciones del gen TP53 reportadas por los consorcios TCGA, ICGC y GENIE. Tanto los resultados numéricos como los gráficos de dispersión muestran que las variables presentan una relación prácticamente nula.

Por otra parte, la edad al diagnóstico mostró una correlación estadísticamente significativa con el conteo de mutaciones (p = 0.011); sin embargo, el coeficiente obtenido (ρ = –0.077) indica que esta asociación es extremadamente débil y carece de importancia práctica. Esto sugiere que la edad al diagnóstico ejerce un efecto mínimo o inexistente en la cantidad de mutaciones registradas.

En conjunto, estos resultados permiten concluir que la variabilidad en el conteo de mutaciones del gen TP53 no se explica por la edad ni por la edad al diagnóstico, lo que implica que otros factores clínicos, biológicos o ambientales podrían tener un papel más determinante en la frecuencia mutacional.

# Respecto a hipótesis

A partir del análisis realizado, no se encontró evidencia sólida que respalde la hipótesis de que la edad al diagnóstico tiene una relación importante con la carga mutacional asociada a TP53. La correlación entre Age_at_diagnosis y el conteo combinado de mutaciones provenientes de los consorcios TCGA, ICGC y GENIE fue estadísticamente significativa (ρ = –0.077, p = 0.011); sin embargo, la magnitud del coeficiente es extremadamente baja, lo que indica que la relación, aunque detectable debido al tamaño de la muestra, no posee relevancia práctica.

Además, la correlación entre la edad general (Age) y el conteo mutacional tampoco mostró significancia estadística (ρ = 0.073, p = 0.246), reforzando la idea de que la edad no explica la variación en la cantidad de mutaciones registradas.

Por lo tanto, con base en estos resultados, la hipótesis H2 no puede considerarse apoyada, al menos desde la perspectiva del análisis correlacional asignado. Los datos sugieren que la edad al diagnóstico no está asociada de manera relevante con la frecuencia de mutaciones observadas, por lo que otros factores biológicos, genéticos o clínicos podrían ser más determinantes en la variabilidad mutacional.

